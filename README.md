# Домашнее задание к занятию «SQL. Часть 1» - Крюков Егор

Задание можно выполнить как в любом IDE, так и в командной строке.

### Задание 1

Получите уникальные названия районов из таблицы с адресами, которые начинаются на “K” и заканчиваются на “a” и не содержат пробелов.

### Решение

Чтобы получить названия районов, которые начинаются на “K” и заканчиваются на “a” и не содержат пробелов. Нужно выполнить слежующий запрос.

```sql
SELECT DISTINCT district
FROM address
WHERE district LIKE 'K%' 
  AND district LIKE '%a' 
  AND district NOT LIKE '% %';

```
В ответ получим такую таблицу с данными.

| district  |
| ----------|
| Kanagawa  |
| Kalmykia  |
| Kaduna    |
| Karnataka |
| Kütahya   |
| Kerala    |
| Kitaa     |


### Задание 2

Получите из таблицы платежей за прокат фильмов информацию по платежам, которые выполнялись в промежуток с 15 июня 2005 года по 18 июня 2005 года **включительно** и стоимость которых превышает 10.00.

### Решение

Для просмотра платежей, нужно выполнить такой запрос. 

```sql
SELECT *
FROM payment
WHERE payment_date BETWEEN '2005-06-15' AND '2005-06-18'
  AND amount > 10.00;

```
В ответ получим такую таблицу с данными.

| payment_id | customer_id | staff_id | rental_id | amount | payment_date        | last_update         |
|------------|-------------|----------|-----------|--------|---------------------|---------------------|
|        908 |          33 |        1 |      1301 |  10.99 | 2005-06-15 09:46:33 | 2006-02-15 22:12:36 |
|       7017 |         260 |        1 |      2091 |  10.99 | 2005-06-17 18:09:04 | 2006-02-15 22:14:58 |
|       8272 |         305 |        1 |      2166 |  11.99 | 2005-06-17 23:51:21 | 2006-02-15 22:15:47 |
|      13892 |         516 |        1 |      1718 |  10.99 | 2005-06-16 14:52:02 | 2006-02-15 22:20:47 |
|      14620 |         544 |        2 |      1434 |  10.99 | 2005-06-15 18:30:46 | 2006-02-15 22:21:35 |
|      15313 |         572 |        2 |      1889 |  10.99 | 2005-06-17 04:05:12 | 2006-02-15 22:22:22 |



### Задание 3

Получите последние пять аренд фильмов.

### Решение

Для просмотра аренд фильмов, нужно выполнить такой запрос. 

```sql
SELECT *
FROM rental
ORDER BY rental_date DESC
LIMIT 5;

```

В ответ получим такую таблицу с данными.

| rental_id | rental_date         | inventory_id | customer_id | return_date | staff_id | last_update         |
|-----------|---------------------|--------------|-------------|-------------|----------|---------------------|
|     11739 | 2006-02-14 15:16:03 |         4568 |         373 | NULL        |        2 | 2006-02-15 21:30:53 |
|     14616 | 2006-02-14 15:16:03 |         4537 |         532 | NULL        |        1 | 2006-02-15 21:30:53 |
|     11676 | 2006-02-14 15:16:03 |         4496 |         216 | NULL        |        2 | 2006-02-15 21:30:53 |
|     15966 | 2006-02-14 15:16:03 |         4472 |         374 | NULL        |        1 | 2006-02-15 21:30:53 |
|     13486 | 2006-02-14 15:16:03 |         4460 |         274 | NULL        |        1 | 2006-02-15 21:30:53 |

### Задание 4

Одним запросом получите активных покупателей, имена которых Kelly или Willie. 

Сформируйте вывод в результат таким образом:
- все буквы в фамилии и имени из верхнего регистра переведите в нижний регистр,
- замените буквы 'll' в именах на 'pp'.

### Решение

Для просмотра активных покупателей, имена которых Kelly или Willie с переводом в нижний регистр и заменой ll на pp, нужно выполнить такой запрос. 

```sql
SELECT 
    customer_id,
    REGEXP_REPLACE(LOWER(first_name), 'll', 'pp') AS modified_first_name,
    LOWER(last_name) AS modified_last_name,
    email,
    active
FROM 
    customer
WHERE 
    first_name REGEXP 'Kelly|Willie'
    AND active = 1;
```

В ответ получим такую таблицу с данными.

| customer_id | modified_first_name | modified_last_name | email                             | active |
|-------------|---------------------|--------------------|-----------------------------------|--------|
|          67 | keppy               | torres             | KELLY.TORRES@sakilacustomer.org   |      1 |
|         219 | wippie              | howell             | WILLIE.HOWELL@sakilacustomer.org  |      1 |
|         359 | wippie              | markham            | WILLIE.MARKHAM@sakilacustomer.org |      1 |
|         546 | keppy               | knott              | KELLY.KNOTT@sakilacustomer.org    |      1 |
